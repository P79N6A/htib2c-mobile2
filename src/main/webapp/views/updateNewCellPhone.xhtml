<!DOCTYPE html>
<html>

<body style="z-index: 2">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./template.xhtml">

    <ui:define name="header">
          更新联系方式
    </ui:define>

    <ui:define name="workspace">
        <link rel="stylesheet" href="#{facesContext.externalContext.request.contextPath}/resources/css/themes/hti5/css.css" charset="utf-8" />
        <link rel="stylesheet" href="#{facesContext.externalContext.request.contextPath}/resources/css/themes/hti5/swiper.css" charset="utf-8" />
        <h:form  id="condition">
        <div class="page">
            <div id="fri_top">
                <img src="#{facesContext.externalContext.request.contextPath}/resources/images/img/logo.png"
                     id="logo" />
            </div>

            <div id="fri_mod">
                <img src="#{facesContext.externalContext.request.contextPath}/resources/images/img/fri_line.jpg"
                     id="linetop"/>
                <img src="#{facesContext.externalContext.request.contextPath}/resources/images/img/fri_line2.jpg"
                     id="linebot"/>               
                <ul style="top:90px;">
                    <li >请输入你最新的联系方式：</li>
                    <li style="padding-top:40px">
                    <h:inputText id="newCellPhone"
                                     value="#{mobileBean.newCellPhone}" maxlength="11"  required="true" requiredMessage="The field is empty"  >
                        <f:passThroughAttribute name="placeholder" value="手机或座机号码" />
                        <f:passThroughAttribute name="pattern"
                                                value="[0-9]*"/>
                        <f:passThroughAttribute name="phone"  value="newCellPhone"/>
                    </h:inputText>
                    <h:inputText id="repMessage"
                                     value="#{mobileBean.repMessage}"
                                     style="display: none">
                          <f:passThroughAttribute name="nm" value="repMessage"/>
                      </h:inputText>
                    </li>
                    <li style="padding-top:70px;text-align: center;padding-right: 70px;font-size: 24px;">备注：此联系方式更新不影响车辆主要驾驶人联系方式，若要更新主要驾驶人联系方式，请致电 400-898-0050。
                    </li>
                </ul>
            </div>
            <div id="fri_bottom">
                <div class="empty">
                    <h:commandButton id="form_phone" disabled="disabled" action="#{mobileBean.updateNewCellPhoneByAccountNum}" value="提&#160;&#160;交" onclick="return showLogOff();" />
                    <!--    <input type="button" value="提&#160;&#160;交" onclick="showLogOff()"/> -->
                    
                </div>
                <div id="keytxt">网站备案号：京ICP备11011340号</div>
            </div>
        </div> 
         <!-- 输入格式不对 -->
            <div class="alert" id="sn_err" style="display:none;padding-top: 10px;z-index: 6;">
	             <div class="a_txt" id="perro">错误提示：输入有误，请检查后重新输入<br/></div> 
                <div id = "retryBtn" class="m_btn m_btn1" onclick="hideLogOff()" style="margin-top: 30px;">重 新 输入</div>
            </div>                              
            <script type="text/javascript">
	        var repMessageVal = $("input[nm='repMessage']").val();
            $(function(){  
	           	 console.log(repMessageVal);
		          if(repMessageVal == null || repMessageVal == ""){
		              $('#sn_err').hide();
		          }else{
		              if(repMessageVal == "success"){
		            	 $('#perro').html("您的请求已成功提交！");
		            	 $('#retryBtn').html("确定");
			             $('#sn_err').show();
		              }else if(repMessageVal == "alreadyUpdate"){
	            	 	$('#perro').html("您已经更改过最新联系方式，如需修改请重新输入新的联系方式！");
		            	$('#retryBtn').html("重 新 输入");
			            $('#sn_err').show();
		              }	             
	         	 }
            })
            function closeUp(){$('#sn_err').hide();$("input[nm='repMessage']").attr('');}
	            function showLogOff(){
	            	var flag=false;
	            	$('#perro').html("错误提示：输入有误，请检查后重新输入");
		            $('#retryBtn').html("重 新 输入");
	            	var newCellPhone=$("input[phone='newCellPhone']").val();
	            	var regex= /^((0\d{2,3}\d{7,8})|(1[3584]\d{9}))$/;
	            	if(newCellPhone.length==11){
	            		if(regex.test(newCellPhone)){
	            			flag=true;
	            		}else{
	            			$('#sn_err').show();
	            		}	            		
	            	}else{
	            		$('#sn_err').show();
	            	}
	            	return flag;
	            }	            
	            function hideLogOff() {
                    $('#sn_err').hide();
                }
            </script>
        </h:form>
    </ui:define>

</ui:composition>
</body>
</html>